{"ast":null,"code":"var _jsxFileName = \"D:\\\\Blockchain Ballot\\\\frontend\\\\src\\\\pages\\\\Election\\\\Election.js\",\n    _s = $RefreshSig$();\n\n/**\r\n * @prettier\r\n */\nimport { useContext, useEffect, useState } from 'react';\nimport AuthContext from '../../store/auth-context';\nimport Electioneth from '../../ethereum/election';\nimport ShowCandidate from './ShowCandidate';\nimport Loading from '../../components/Loading';\nimport { useNavigate } from 'react-router';\nimport StartElection from './StartElection';\nimport EndElection from './EndElection';\nimport { useEndElection } from '../../components/hooks/end-election';\nimport { Link } from 'react-router-dom';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\n\nconst Election = () => {\n  _s();\n\n  const {\n    user,\n    election,\n    notify\n  } = useContext(AuthContext);\n  const [loading, setLoading] = useState(false);\n  let tempCandidate;\n  const navigate = useNavigate();\n  const [candidates, setCandidates] = useState([]);\n  const [candidateCount, setCount] = useState(0);\n  const [electionName, setElectionName] = useState(''); //for validation\n\n  useEffect(() => {\n    (async () => {\n      if (!user) {\n        notify('Please login first', 'error');\n        navigate('/login');\n      } else {\n        //get intial value of validAccount, if the user is using right ethereum ot not\n        //getAccount();\n        //checking if there is no ongoing election\n        if (election === '0x0000000000000000000000000000000000000000') {\n          navigate('/');\n        } //election.ongoing is only true if admin adds an election\n\n\n        if (user.electionOngoing === false && user.role !== 'admin') {\n          notify('There is no ongoing election', 'error');\n          navigate('/');\n        }\n      }\n    })();\n  }); //to get all candidates\n\n  useEffect(() => {\n    let b = async () => {\n      //try{\n      setLoading(true);\n\n      if (election !== '0x0000000000000000000000000000000000000000') {\n        const Election = Electioneth(election); //getting candidate count\n\n        let count = await Election.methods.candidateCount().call();\n        setCount(+count); //getting election name\n\n        let name = await Election.methods.electionName().call();\n        setElectionName(name); //getting all candidates and storing in one variable\n\n        tempCandidate = await Promise.all(Array(+count).fill(1).map((element, index) => {\n          return Election.methods.candidates(index).call();\n        }));\n        setCandidates(tempCandidate); //console.log(tempCandidate);\n      }\n\n      setLoading(false);\n    };\n\n    b();\n    return () => {\n      b = null;\n    };\n  }, []); // //use effect to remove bug where user rejects second transaction while ending election\n\n  useEndElection('election', setLoading);\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: [!loading && candidateCount >= 0 && /*#__PURE__*/_jsxDEV(\"h2\", {\n      className: \"mt-5 text-center text-3xl font-bold mb-8 text-gray-900\",\n      children: electionName\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 86,\n      columnNumber: 13\n    }, this), !loading && candidateCount === 0 && /*#__PURE__*/_jsxDEV(\"h2\", {\n      className: \"mt-5 text-center text-3xl font-bold mb-8 text-gray-900\",\n      children: \"No Candidates\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 91,\n      columnNumber: 13\n    }, this), !loading && election !== '0x0000000000000000000000000000000000000000' && candidateCount > 0 && /*#__PURE__*/_jsxDEV(_Fragment, {\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"grid lg:grid-cols-2 md:grid-cols-2 sm:grid-cols-1 \",\n          children: candidateCount && candidates.map((candidate, index) => /*#__PURE__*/_jsxDEV(ShowCandidate, {\n            id: index,\n            candidate: candidate,\n            candidateCount: candidateCount,\n            setLoading: setLoading\n          }, index, false, {\n            fileName: _jsxFileName,\n            lineNumber: 104,\n            columnNumber: 31\n          }, this))\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 101,\n          columnNumber: 22\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"flex mt-3 relative justify-center\",\n          children: user && !user.electionOngoing && user.role === 'admin' && /*#__PURE__*/_jsxDEV(_Fragment, {\n            children: [/*#__PURE__*/_jsxDEV(StartElection, {\n              setLoading: setLoading\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 116,\n              columnNumber: 31\n            }, this), /*#__PURE__*/_jsxDEV(Link, {\n              to: \"/addCandidate \",\n              children: /*#__PURE__*/_jsxDEV(\"button\", {\n                className: \"lg:w-40 md:w-30 ml-2 flex justify-center py-2 px-4 border border-transparent text-sm font-medium rounded-sm text-white bg-indigo-500 hover:bg-indigo-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-400\",\n                children: \"Add Candidate\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 119,\n                columnNumber: 34\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 118,\n              columnNumber: 31\n            }, this)]\n          }, void 0, true)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 113,\n          columnNumber: 22\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"flex justify-end lg:px-24 md:px-8 px-4 \",\n          children: user && user.electionOngoing && user.role === 'admin' && /*#__PURE__*/_jsxDEV(\"button\", {\n            className: \"w-40 ml-6 flex justify-center py-2 px-4 border border-transparent text-sm font-medium rounded-sm text-white bg-indigo-500 hover:bg-indigo-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-400\",\n            children: /*#__PURE__*/_jsxDEV(EndElection, {\n              setLoading: setLoading\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 129,\n              columnNumber: 31\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 128,\n            columnNumber: 28\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 126,\n          columnNumber: 22\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 100,\n        columnNumber: 19\n      }, this)\n    }, void 0, false), loading && /*#__PURE__*/_jsxDEV(Loading, {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 136,\n      columnNumber: 22\n    }, this)]\n  }, void 0, true);\n};\n\n_s(Election, \"0A8lnVzf+VsQzBb+QGo2BYp5LKQ=\", false, function () {\n  return [useNavigate, useEndElection];\n});\n\n_c = Election;\nexport default Election;\n\nvar _c;\n\n$RefreshReg$(_c, \"Election\");","map":{"version":3,"sources":["D:/Blockchain Ballot/frontend/src/pages/Election/Election.js"],"names":["useContext","useEffect","useState","AuthContext","Electioneth","ShowCandidate","Loading","useNavigate","StartElection","EndElection","useEndElection","Link","Election","user","election","notify","loading","setLoading","tempCandidate","navigate","candidates","setCandidates","candidateCount","setCount","electionName","setElectionName","electionOngoing","role","b","count","methods","call","name","Promise","all","Array","fill","map","element","index","candidate"],"mappings":"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","sourcesContent":["/**\r\n * @prettier\r\n */\r\nimport { useContext, useEffect, useState } from 'react';\r\nimport AuthContext from '../../store/auth-context';\r\nimport Electioneth from '../../ethereum/election';\r\nimport ShowCandidate from './ShowCandidate';\r\nimport Loading from '../../components/Loading';\r\nimport { useNavigate } from 'react-router';\r\nimport StartElection from './StartElection';\r\nimport EndElection from './EndElection';\r\nimport { useEndElection } from '../../components/hooks/end-election';\r\nimport { Link } from 'react-router-dom';\r\n\r\nconst Election = () => {\r\n   const { user, election, notify } = useContext(AuthContext);\r\n   const [loading, setLoading] = useState(false);\r\n   let tempCandidate;\r\n   const navigate = useNavigate();\r\n   const [candidates, setCandidates] = useState([]);\r\n   const [candidateCount, setCount] = useState(0);\r\n   const [electionName, setElectionName] = useState('');\r\n\r\n   //for validation\r\n   useEffect(() => {\r\n      (async () => {\r\n         if (!user) {\r\n            notify('Please login first', 'error');\r\n            navigate('/login');\r\n         } else {\r\n            //get intial value of validAccount, if the user is using right ethereum ot not\r\n            //getAccount();\r\n            //checking if there is no ongoing election\r\n            if (election === '0x0000000000000000000000000000000000000000') {\r\n               navigate('/');\r\n            }\r\n            //election.ongoing is only true if admin adds an election\r\n            if (user.electionOngoing === false && user.role !== 'admin') {\r\n               notify('There is no ongoing election', 'error');\r\n               navigate('/');\r\n            }\r\n         }\r\n      })();\r\n   });\r\n   //to get all candidates\r\n   useEffect(() => {\r\n      let b = async () => {\r\n         //try{\r\n         setLoading(true);\r\n         if (election !== '0x0000000000000000000000000000000000000000') {\r\n            const Election = Electioneth(election);\r\n            //getting candidate count\r\n            let count = await Election.methods.candidateCount().call();\r\n            setCount(+count);\r\n\r\n            //getting election name\r\n            let name = await Election.methods.electionName().call();\r\n            setElectionName(name);\r\n\r\n            //getting all candidates and storing in one variable\r\n\r\n            tempCandidate = await Promise.all(\r\n               Array(+count)\r\n                  .fill(1)\r\n                  .map((element, index) => {\r\n                     return Election.methods.candidates(index).call();\r\n                  })\r\n            );\r\n            setCandidates(tempCandidate);\r\n            //console.log(tempCandidate);\r\n         }\r\n         setLoading(false);\r\n      };\r\n      b();\r\n      return () => {\r\n         b = null;\r\n      };\r\n   }, []);\r\n\r\n   // //use effect to remove bug where user rejects second transaction while ending election\r\n   useEndElection('election', setLoading);\r\n\r\n   return (\r\n      <>\r\n         {!loading && candidateCount >= 0 && (\r\n            <h2 className='mt-5 text-center text-3xl font-bold mb-8 text-gray-900'>\r\n               {electionName}\r\n            </h2>\r\n         )}\r\n         {!loading && candidateCount === 0 && (\r\n            <h2 className='mt-5 text-center text-3xl font-bold mb-8 text-gray-900'>\r\n               No Candidates\r\n            </h2>\r\n         )}\r\n         {!loading &&\r\n            election !== '0x0000000000000000000000000000000000000000' &&\r\n            candidateCount > 0 && (\r\n               <>\r\n                  {/* <th>Vote</th> */}\r\n                  <div className=''>\r\n                     <div className='grid lg:grid-cols-2 md:grid-cols-2 sm:grid-cols-1 '>\r\n                        {candidateCount &&\r\n                           candidates.map((candidate, index) => (\r\n                              <ShowCandidate\r\n                                 key={index}\r\n                                 id={index}\r\n                                 candidate={candidate}\r\n                                 candidateCount={candidateCount}\r\n                                 setLoading={setLoading}\r\n                              />\r\n                           ))}\r\n                     </div>\r\n                     <div className='flex mt-3 relative justify-center'>\r\n                        {user && !user.electionOngoing && user.role === 'admin' && (\r\n                           <>\r\n                              <StartElection setLoading={setLoading} />\r\n\r\n                              <Link to='/addCandidate '>\r\n                                 <button className='lg:w-40 md:w-30 ml-2 flex justify-center py-2 px-4 border border-transparent text-sm font-medium rounded-sm text-white bg-indigo-500 hover:bg-indigo-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-400'>\r\n                                    Add Candidate\r\n                                 </button>\r\n                              </Link>\r\n                           </>\r\n                        )}\r\n                     </div>\r\n                     <div className='flex justify-end lg:px-24 md:px-8 px-4 '>\r\n                        {user && user.electionOngoing && user.role === 'admin' && (\r\n                           <button className='w-40 ml-6 flex justify-center py-2 px-4 border border-transparent text-sm font-medium rounded-sm text-white bg-indigo-500 hover:bg-indigo-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-400'>\r\n                              <EndElection setLoading={setLoading} />\r\n                           </button>\r\n                        )}\r\n                     </div>\r\n                  </div>\r\n               </>\r\n            )}\r\n         {loading && <Loading />}\r\n      </>\r\n   );\r\n};\r\n\r\nexport default Election;\r\n"]},"metadata":{},"sourceType":"module"}