{"ast":null,"code":"var _jsxFileName = \"D:\\\\Blockchain Ballot\\\\frontend\\\\src\\\\pages\\\\Election\\\\ShowCandidate.js\",\n    _s = $RefreshSig$();\n\n/**\r\n * @prettier\r\n */\nimport { useContext, useEffect, useState } from 'react';\nimport AuthContext from '../../store/auth-context';\nimport Electioneth from '../../ethereum/election';\nimport axios from 'axios';\nimport web3 from '../../ethereum/web3';\nimport { useNavigate } from 'react-router';\nimport { Link } from 'react-router-dom';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\n\nconst ShowCandidate = _ref => {\n  _s();\n\n  let {\n    id,\n    candidate,\n    candidateCount,\n    setLoading\n  } = _ref;\n  const {\n    user,\n    validAccount,\n    notify,\n    election,\n    setUser\n  } = useContext(AuthContext);\n  const [vote, setVote] = useState(+candidate.votes);\n  const navigate = useNavigate();\n  useEffect(() => {\n    const b = async () => {\n      const Election = Electioneth(election);\n      let newCandidate = await Election.methods.candidates(id).call();\n      let candidateVote = newCandidate.votes;\n      setVote(candidateVote);\n    };\n\n    b();\n    return () => b;\n  });\n\n  const voteHandler = async e => {\n    e.preventDefault();\n    setLoading(true);\n    const account = await web3.eth.getAccounts();\n\n    if (account[0] !== user.eAddress) {\n      notify('You are using wrong ethereum account', 'error');\n      setLoading(false);\n      return;\n    } //voting the candidate and retriving latest candidate vote count\n\n\n    try {\n      const Election = Electioneth(election);\n      const accounts = await web3.eth.getAccounts();\n      await Election.methods.voteCandidate(id).send({\n        from: accounts[0]\n      });\n      setVote(prevVote => prevVote + 1);\n      notify('You have successfully voted a candidate', 'success');\n    } catch (err) {\n      notify(err.message, 'error');\n      setLoading(false);\n      return;\n    }\n\n    try {\n      //send a put request\n      const response = await axios.put('/election/vote', {}, {\n        withCredentials: true\n      });\n      setUser(response.data.user);\n    } catch (err) {\n      notify(err.response.data.errMessage, 'error');\n      setLoading(false);\n      return;\n    }\n\n    console.log(vote);\n    setLoading(false); // navigate('/election')\n  };\n\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"flex justify-start mt-5 mx-5\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"flex filter drop-shadow-xl flex-col lg:flex-row rounded-lg hover:shadow-xl shadow-lg bg-gray-200\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"my-auto mx-auto items-center justify-center pl-2 \",\n          children: [/*#__PURE__*/_jsxDEV(\"img\", {\n            className: \"mt-3 lg:h-20 max-w-lg lg:w-20 md:h-16 md:w-16 w-32 h-32 rounded-full object-cover\",\n            src: `${candidate.url}`\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 76,\n            columnNumber: 19\n          }, this), /*#__PURE__*/_jsxDEV(\"h5\", {\n            className: \"text-gray-900 lg:text-lg md:text-md text-center font-medium mb-2\",\n            children: candidate.name\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 80,\n            columnNumber: 19\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 75,\n          columnNumber: 16\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"py-4 px-2 flex flex-col justify-start md:max-w-l lg:max-w-md\",\n          children: [/*#__PURE__*/_jsxDEV(\"p\", {\n            className: \"text-gray-700 mb-4 text-sm\",\n            children: candidate.description\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 86,\n            columnNumber: 19\n          }, this), user && user.electionOngoing && !user.hasVoted && /*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: voteHandler,\n            className: \"mx-auto relative w-3/4 rounded-lg border border-transparent py-2 mt-5 text-sm font-medium text-white bg-indigo-500 hover:bg-indigo-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-400\",\n            children: \"Vote\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 88,\n            columnNumber: 22\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 85,\n          columnNumber: 16\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 74,\n        columnNumber: 13\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 73,\n      columnNumber: 10\n    }, this)\n  }, void 0, false);\n};\n\n_s(ShowCandidate, \"91VIvKMotsmq7NW0xjnLl/bOz9Y=\", false, function () {\n  return [useNavigate];\n});\n\n_c = ShowCandidate;\nexport default ShowCandidate;\n\nvar _c;\n\n$RefreshReg$(_c, \"ShowCandidate\");","map":{"version":3,"sources":["D:/Blockchain Ballot/frontend/src/pages/Election/ShowCandidate.js"],"names":["useContext","useEffect","useState","AuthContext","Electioneth","axios","web3","useNavigate","Link","ShowCandidate","id","candidate","candidateCount","setLoading","user","validAccount","notify","election","setUser","vote","setVote","votes","navigate","b","Election","newCandidate","methods","candidates","call","candidateVote","voteHandler","e","preventDefault","account","eth","getAccounts","eAddress","accounts","voteCandidate","send","from","prevVote","err","message","response","put","withCredentials","data","errMessage","console","log","url","name","description","electionOngoing","hasVoted"],"mappings":"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","sourcesContent":["/**\r\n * @prettier\r\n */\r\nimport { useContext, useEffect, useState } from 'react';\r\nimport AuthContext from '../../store/auth-context';\r\nimport Electioneth from '../../ethereum/election';\r\nimport axios from 'axios';\r\nimport web3 from '../../ethereum/web3';\r\nimport { useNavigate } from 'react-router';\r\nimport { Link } from 'react-router-dom';\r\n\r\nconst ShowCandidate = ({ id, candidate, candidateCount, setLoading }) => {\r\n   const { user, validAccount, notify, election, setUser } = useContext(AuthContext);\r\n   const [vote, setVote] = useState(+candidate.votes);\r\n   const navigate = useNavigate();\r\n   useEffect(() => {\r\n      const b = async () => {\r\n         const Election = Electioneth(election);\r\n         let newCandidate = await Election.methods.candidates(id).call();\r\n         let candidateVote = newCandidate.votes;\r\n         setVote(candidateVote);\r\n      };\r\n      b();\r\n      return () => b;\r\n   });\r\n   const voteHandler = async (e) => {\r\n      e.preventDefault();\r\n      setLoading(true);\r\n\r\n      const account = await web3.eth.getAccounts();\r\n      if (account[0] !== user.eAddress) {\r\n         notify('You are using wrong ethereum account', 'error');\r\n         setLoading(false);\r\n         return;\r\n      }\r\n      //voting the candidate and retriving latest candidate vote count\r\n      try {\r\n         const Election = Electioneth(election);\r\n         const accounts = await web3.eth.getAccounts();\r\n         await Election.methods.voteCandidate(id).send({\r\n            from: accounts[0],\r\n         });\r\n         setVote((prevVote) => prevVote + 1);\r\n         notify('You have successfully voted a candidate', 'success');\r\n      } catch (err) {\r\n         notify(err.message, 'error');\r\n         setLoading(false);\r\n         return;\r\n      }\r\n      try {\r\n         //send a put request\r\n         const response = await axios.put(\r\n            '/election/vote',\r\n            {},\r\n            {\r\n               withCredentials: true,\r\n            }\r\n         );\r\n         setUser(response.data.user);\r\n      } catch (err) {\r\n         notify(err.response.data.errMessage, 'error');\r\n         setLoading(false);\r\n         return;\r\n      }\r\n\r\n      console.log(vote);\r\n\r\n      setLoading(false);\r\n      // navigate('/election')\r\n   };\r\n   return (\r\n      <>\r\n         <div className='flex justify-start mt-5 mx-5'>\r\n            <div className='flex filter drop-shadow-xl flex-col lg:flex-row rounded-lg hover:shadow-xl shadow-lg bg-gray-200'>\r\n               <div className='my-auto mx-auto items-center justify-center pl-2 '>\r\n                  <img\r\n                     className='mt-3 lg:h-20 max-w-lg lg:w-20 md:h-16 md:w-16 w-32 h-32 rounded-full object-cover'\r\n                     src={`${candidate.url}`}\r\n                  />\r\n                  <h5 className='text-gray-900 lg:text-lg md:text-md text-center font-medium mb-2'>\r\n                     {candidate.name}\r\n                  </h5>\r\n               </div>\r\n\r\n               <div className='py-4 px-2 flex flex-col justify-start md:max-w-l lg:max-w-md'>\r\n                  <p className='text-gray-700 mb-4 text-sm'>{candidate.description}</p>\r\n                  {user && user.electionOngoing && !user.hasVoted && (\r\n                     <button\r\n                        onClick={voteHandler}\r\n                        className='mx-auto relative w-3/4 rounded-lg border border-transparent py-2 mt-5 text-sm font-medium text-white bg-indigo-500 hover:bg-indigo-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-400'\r\n                     >\r\n                        Vote\r\n                     </button>\r\n                  )}\r\n               </div>\r\n            </div>\r\n         </div>\r\n         {/* <tr>\r\n            <td>{candidate.name}</td>\r\n            <td>{candidate.description}</td>\r\n            <td>{vote}</td>\r\n            {user && user.electionOngoing && !user.hasVoted && (\r\n               <td>\r\n                  <button onClick={voteHandler}>Vote</button>\r\n               </td>\r\n            )}\r\n            {/* <td><button onClick={voteHandler}>Vote</button></td> */}\r\n         {/* {user && user.role === 'admin' && !user.electionOngoing}\r\n            <td>{candidate.url}</td>\r\n            <td>\r\n               <Link to='/editCandidate'>Edit Candidate</Link>\r\n            </td>\r\n         </tr>  */}\r\n      </>\r\n   );\r\n};\r\nexport default ShowCandidate;\r\n"]},"metadata":{},"sourceType":"module"}